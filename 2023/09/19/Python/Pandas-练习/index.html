<!DOCTYPE html>
<html lang=zh>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>Pandas 练习 | WINGO BLOG</title>
  <meta name="description" content="12import numpy as npimport pandas as pd 12data &#x3D; &amp;#123;&quot;grammer&quot;:[&quot;Python&quot;,&quot;C&quot;,&quot;Java&quot;,&quot;GO&quot;,&quot;R&quot;,&quot;SQL&quot;,&quot;PHP&quot;,&quot;Python&amp;">
<meta property="og:type" content="article">
<meta property="og:title" content="Pandas 练习">
<meta property="og:url" content="https://wingowen.github.io/2023/09/19/Python/Pandas-%E7%BB%83%E4%B9%A0/index.html">
<meta property="og:site_name" content="WINGO&#39;S BLOG">
<meta property="og:description" content="12import numpy as npimport pandas as pd 12data &#x3D; &amp;#123;&quot;grammer&quot;:[&quot;Python&quot;,&quot;C&quot;,&quot;Java&quot;,&quot;GO&quot;,&quot;R&quot;,&quot;SQL&quot;,&quot;PHP&quot;,&quot;Python&amp;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://wingowen.github.io/img/pandas_files/pandas_34_1.png">
<meta property="og:image" content="https://wingowen.github.io/img/pandas_files/pandas_35_1.png">
<meta property="og:image" content="https://wingowen.github.io/img/pandas_files/pandas_61_1.png">
<meta property="og:image" content="https://wingowen.github.io/img/pandas_files/pandas_62_2.png">
<meta property="og:image" content="https://wingowen.github.io/img/pandas_files/pandas_63_1.png">
<meta property="og:image" content="https://wingowen.github.io/img/pandas_files/pandas_64_1.png">
<meta property="og:image" content="https://wingowen.github.io/img/pandas_files/pandas_69_1.png">
<meta property="og:image" content="https://wingowen.github.io/img/pandas_files/pandas_76_2.png">
<meta property="og:image" content="https://wingowen.github.io/img/pandas_files/pandas_78_2.png">
<meta property="og:image" content="https://wingowen.github.io/img/pandas_files/pandas_80_2.png">
<meta property="og:image" content="https://wingowen.github.io/img/pandas_files/pandas_83_1.png">
<meta property="article:published_time" content="2023-09-19T07:11:03.000Z">
<meta property="article:modified_time" content="2023-09-19T07:40:22.864Z">
<meta property="article:author" content="Wingo Wen">
<meta property="article:tag" content="Pandas">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://wingowen.github.io/img/pandas_files/pandas_34_1.png">
  <!-- Canonical links -->
  <link rel="canonical" href="https://wingowen.github.io/2023/09/19/Python/Pandas-%E7%BB%83%E4%B9%A0/index.html">
  
  
    <link rel="icon" href="/favicon.png" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  
  
  
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.1.0"><link rel="alternate" href="/atom.xml" title="WINGO'S BLOG" type="application/atom+xml">
</head>


<body class="main-center" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="" target="_blank">
          <img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">WINGO.WEN</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md"></h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Shenzhen, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav menu-highlight">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">首页</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-tags">
          <a href="/tags">
            
            <i class="icon icon-tags"></i>
            
            <span class="menu-title">标签</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">分类</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">归档</span>
          </a>
        </li>
        
      </ul>
      
    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p>得失从缘 心无增减</p>
            </div>
        </div>
    </div>
</div>

    
      
  <div class="widget">
    <h3 class="widget-title">分类</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%90%8E%E5%8F%B0%E6%8A%80%E6%9C%AF/">后台技术</a><span class="category-list-count">23</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%9F%BA%E7%A1%80%E7%A7%91%E5%AD%A6/">基础科学</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%97%A5%E5%B8%B8/">日常</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9D%82%E9%A1%B9/">杂项</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E7%A8%8B/">编程</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/">计算机科学</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%BF%90%E7%BB%B4/">运维</a><span class="category-list-count">3</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">标签云</h3>
    <div class="widget-body tagcloud">
      <a href="/tags/Aysnc/" style="font-size: 13px;">Aysnc</a> <a href="/tags/Cache/" style="font-size: 13px;">Cache</a> <a href="/tags/Druid/" style="font-size: 13px;">Druid</a> <a href="/tags/Dubbo/" style="font-size: 13px;">Dubbo</a> <a href="/tags/ElasticSearch/" style="font-size: 13px;">ElasticSearch</a> <a href="/tags/Email/" style="font-size: 13px;">Email</a> <a href="/tags/Flume/" style="font-size: 13px;">Flume</a> <a href="/tags/HBase/" style="font-size: 13px;">HBase</a> <a href="/tags/Hadoop/" style="font-size: 13px;">Hadoop</a> <a href="/tags/Hexo/" style="font-size: 13px;">Hexo</a> <a href="/tags/Hive/" style="font-size: 13.25px;">Hive</a> <a href="/tags/Impala/" style="font-size: 13px;">Impala</a> <a href="/tags/InooDB/" style="font-size: 13px;">InooDB</a> <a href="/tags/JDBC/" style="font-size: 13px;">JDBC</a> <a href="/tags/JPA/" style="font-size: 13px;">JPA</a> <a href="/tags/Java/" style="font-size: 13px;">Java</a> <a href="/tags/Kafka/" style="font-size: 13px;">Kafka</a> <a href="/tags/Kudu/" style="font-size: 13px;">Kudu</a> <a href="/tags/Log/" style="font-size: 13px;">Log</a> <a href="/tags/MQ/" style="font-size: 13.25px;">MQ</a> <a href="/tags/MyBatis/" style="font-size: 13px;">MyBatis</a> <a href="/tags/Netty/" style="font-size: 14px;">Netty</a> <a href="/tags/Pandas/" style="font-size: 13px;">Pandas</a> <a href="/tags/Python/" style="font-size: 13px;">Python</a> <a href="/tags/SQL/" style="font-size: 13px;">SQL</a> <a href="/tags/Scheduled/" style="font-size: 13px;">Scheduled</a> <a href="/tags/Security/" style="font-size: 13px;">Security</a> <a href="/tags/Shiro/" style="font-size: 13px;">Shiro</a> <a href="/tags/Spring-Boot/" style="font-size: 14px;">Spring Boot</a> <a href="/tags/Web/" style="font-size: 13px;">Web</a> <a href="/tags/WebSocket/" style="font-size: 13px;">WebSocket</a> <a href="/tags/gRPC/" style="font-size: 13px;">gRPC</a> <a href="/tags/sklearn/" style="font-size: 13px;">sklearn</a> <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" style="font-size: 13.75px;">机器学习</a> <a href="/tags/%E7%BD%91%E7%AB%99%E6%94%B6%E9%9B%86/" style="font-size: 13px;">网站收集</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E7%9B%B8%E5%85%B3/" style="font-size: 13px;">网络相关</a> <a href="/tags/%E8%80%83%E7%A0%94/" style="font-size: 13.5px;">考研</a> <a href="/tags/%E8%84%9A%E6%9C%AC%E5%91%BD%E4%BB%A4/" style="font-size: 13px;">脚本命令</a> <a href="/tags/%E9%83%A8%E7%BD%B2/" style="font-size: 13px;">部署</a>
    </div>
  </div>

    
      
  <div class="widget">
    <h3 class="widget-title">归档</h3>
    <div class="widget-body">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/09/">九月 2023</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">一月 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">九月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">八月 2022</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">七月 2022</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">四月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a><span class="archive-list-count">8</span></li></ul>
    </div>
  </div>


    
  </div>
</aside>

  
  
  <aside class="sidebar sidebar-toc collapse   in  " id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <nav id="toc" class="article-toc">
      <h3 class="toc-title">文章目录</h3>
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#PART-02"><span class="toc-number">1.</span> <span class="toc-text">PART 02</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%87%91%E8%9E%8D%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86"><span class="toc-number">2.</span> <span class="toc-text">金融数据处理</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#pandas-amp-numpy"><span class="toc-number">3.</span> <span class="toc-text">pandas &amp; numpy</span></a></li></ol>
    </nav>
  </div>
</aside>

<main class="main" role="main">
  <div class="content">
  <article id="post-Python/Pandas-练习" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      Pandas 练习
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2023/09/19/Python/Pandas-%E7%BB%83%E4%B9%A0/" class="article-date">
	  <time datetime="2023-09-19T07:11:03.000Z" itemprop="datePublished">2023-09-19</time>
	</a>
</span>
        
  <span class="article-category">
    <i class="icon icon-folder"></i>
    <a class="article-category-link" href="/categories/%E7%BC%96%E7%A8%8B/">编程</a>
  </span>

        
  <span class="article-tag">
    <i class="icon icon-tags"></i>
	<a class="article-tag-link-link" href="/tags/Pandas/" rel="tag">Pandas</a>
  </span>


        

        <!-- <span class="post-comment"><i class="icon icon-comment"></i> <a href="/2023/09/19/Python/Pandas-%E7%BB%83%E4%B9%A0/#comments" class="article-comment-link">评论</a></span> -->
        
      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = &#123;<span class="string">&quot;grammer&quot;</span>:[<span class="string">&quot;Python&quot;</span>,<span class="string">&quot;C&quot;</span>,<span class="string">&quot;Java&quot;</span>,<span class="string">&quot;GO&quot;</span>,<span class="string">&quot;R&quot;</span>,<span class="string">&quot;SQL&quot;</span>,<span class="string">&quot;PHP&quot;</span>,<span class="string">&quot;Python&quot;</span>],</span><br><span class="line">       <span class="string">&quot;score&quot;</span>:[<span class="number">1</span>,<span class="number">2</span>,np.nan,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">10</span>]&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(data=data)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[df[<span class="string">&quot;grammer&quot;</span>]==<span class="string">&#x27;Python&#x27;</span>]</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>grammer</th>
      <th>score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Python</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Python</td>
      <td>10.0</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.columns</span><br></pre></td></tr></table></figure>
<pre><code>Index([&#39;grammer&#39;, &#39;score&#39;], dtype=&#39;object&#39;)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.rename(columns=&#123;<span class="string">&#x27;score&#x27;</span>:<span class="string">&#x27;popularity&#x27;</span>&#125;, inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;grammer&#x27;</span>].value_counts()</span><br></pre></td></tr></table></figure>
<pre><code>Python    2
GO        1
Java      1
C         1
R         1
PHP       1
SQL       1
Name: grammer, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 线性插值填充</span></span><br><span class="line">df[<span class="string">&#x27;popularity&#x27;</span>] = df[<span class="string">&#x27;popularity&#x27;</span>].fillna(df[<span class="string">&#x27;popularity&#x27;</span>].interpolate())</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[df[<span class="string">&#x27;popularity&#x27;</span>]&gt;<span class="number">3</span>]</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>grammer</th>
      <th>popularity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>GO</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>R</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>SQL</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>PHP</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Python</td>
      <td>10.0</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.drop_duplicates(subset=[<span class="string">&#x27;grammer&#x27;</span>])</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>grammer</th>
      <th>popularity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Python</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>C</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Java</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>GO</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>R</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>SQL</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>PHP</td>
      <td>7.0</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;popularity&#x27;</span>].mean()</span><br></pre></td></tr></table></figure>
<pre><code>4.75
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;grammer&#x27;</span>].to_list()</span><br></pre></td></tr></table></figure>
<pre><code>[&#39;Python&#39;, &#39;C&#39;, &#39;Java&#39;, &#39;GO&#39;, &#39;R&#39;, &#39;SQL&#39;, &#39;PHP&#39;, &#39;Python&#39;]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.shape</span><br></pre></td></tr></table></figure>
<pre><code>(8, 2)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 改变列的顺序</span></span><br><span class="line">col = df.columns[[<span class="number">1</span>,<span class="number">0</span>]]</span><br><span class="line">df = df[col]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[df[<span class="string">&#x27;popularity&#x27;</span>] == df[<span class="string">&#x27;popularity&#x27;</span>].<span class="built_in">max</span>()]</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>popularity</th>
      <th>grammer</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>10.0</td>
      <td>Python</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[-<span class="number">5</span>:df.shape[<span class="number">0</span>]]</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>popularity</th>
      <th>grammer</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>4.0</td>
      <td>GO</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>R</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6.0</td>
      <td>SQL</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7.0</td>
      <td>PHP</td>
    </tr>
    <tr>
      <th>7</th>
      <td>10.0</td>
      <td>Python</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.tail()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>popularity</th>
      <th>grammer</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>4.0</td>
      <td>GO</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>R</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6.0</td>
      <td>SQL</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7.0</td>
      <td>PHP</td>
    </tr>
    <tr>
      <th>7</th>
      <td>10.0</td>
      <td>Python</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.drop(index=<span class="built_in">len</span>(df)-<span class="number">1</span>, inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">row = &#123;<span class="string">&#x27;popularity&#x27;</span>: <span class="number">6.6</span>, <span class="string">&#x27;grammer&#x27;</span> : <span class="string">&#x27;Perl&#x27;</span>&#125;</span><br><span class="line">df = df.append(row, ignore_index=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = df.sort_values(<span class="string">&quot;popularity&quot;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;grammer&#x27;</span>].<span class="built_in">map</span>(<span class="keyword">lambda</span> x: <span class="built_in">len</span>(x))</span><br></pre></td></tr></table></figure>
<pre><code>0    6
1    1
2    4
3    2
4    1
5    3
7    4
6    3
Name: grammer, dtype: int64
</code></pre><h1 id="PART-02"><a href="#PART-02" class="headerlink" title="PART 02"></a>PART 02</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_excel(<span class="string">&quot;pandas120.xlsx&quot;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.head()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>createTime</th>
      <th>education</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-03-16 11:30:18</td>
      <td>本科</td>
      <td>20k-35k</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-03-16 10:58:48</td>
      <td>本科</td>
      <td>20k-40k</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-03-16 10:46:39</td>
      <td>不限</td>
      <td>20k-35k</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-03-16 10:45:44</td>
      <td>本科</td>
      <td>13k-20k</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-03-16 10:20:41</td>
      <td>本科</td>
      <td>10k-20k</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">cal_ave</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="built_in">min</span>, <span class="built_in">max</span> = x.split(<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>((<span class="built_in">int</span>(<span class="built_in">min</span>[:-<span class="number">1</span>])+<span class="built_in">int</span>(<span class="built_in">max</span>[:-<span class="number">1</span>]))/<span class="number">2</span>*<span class="number">1000</span>)</span><br><span class="line">df[<span class="string">&#x27;salary&#x27;</span>] = df[<span class="string">&#x27;salary&#x27;</span>].apply(cal_ave)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(df[<span class="string">&#x27;education&#x27;</span>]).mean()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>salary</th>
    </tr>
    <tr>
      <th>education</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>不限</th>
      <td>19600.000000</td>
    </tr>
    <tr>
      <th>大专</th>
      <td>10000.000000</td>
    </tr>
    <tr>
      <th>本科</th>
      <td>19361.344538</td>
    </tr>
    <tr>
      <th>硕士</th>
      <td>20642.857143</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;createTime&#x27;</span>] = df[<span class="string">&#x27;createTime&#x27;</span>].<span class="built_in">map</span>(<span class="keyword">lambda</span> x : x.strftime(<span class="string">&#x27;%m-%d&#x27;</span>))</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.info()</span><br></pre></td></tr></table></figure>
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 135 entries, 0 to 134
Data columns (total 3 columns):
 #   Column      Non-Null Count  Dtype 
---  ------      --------------  ----- 
 0   createTime  135 non-null    object
 1   education   135 non-null    object
 2   salary      135 non-null    int64 
dtypes: int64(1), object(2)
memory usage: 3.3+ KB
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.describe()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>135.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>19159.259259</td>
    </tr>
    <tr>
      <th>std</th>
      <td>8661.686922</td>
    </tr>
    <tr>
      <th>min</th>
      <td>3500.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>14000.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>17500.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>25000.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>45000.000000</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bins = [<span class="number">0</span>,<span class="number">5000</span>, <span class="number">20000</span>, <span class="number">50000</span>]</span><br><span class="line">group_names = [<span class="string">&#x27;低&#x27;</span>, <span class="string">&#x27;中&#x27;</span>, <span class="string">&#x27;高&#x27;</span>]</span><br><span class="line">df[<span class="string">&#x27;categories&#x27;</span>] = pd.cut(df[<span class="string">&#x27;salary&#x27;</span>], bins, labels=group_names)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>createTime</th>
      <th>education</th>
      <th>salary</th>
      <th>categories</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>03-16</td>
      <td>本科</td>
      <td>27500</td>
      <td>高</td>
    </tr>
    <tr>
      <th>1</th>
      <td>03-16</td>
      <td>本科</td>
      <td>30000</td>
      <td>高</td>
    </tr>
    <tr>
      <th>2</th>
      <td>03-16</td>
      <td>不限</td>
      <td>27500</td>
      <td>高</td>
    </tr>
    <tr>
      <th>3</th>
      <td>03-16</td>
      <td>本科</td>
      <td>16500</td>
      <td>中</td>
    </tr>
    <tr>
      <th>4</th>
      <td>03-16</td>
      <td>本科</td>
      <td>15000</td>
      <td>中</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>130</th>
      <td>03-16</td>
      <td>本科</td>
      <td>14000</td>
      <td>中</td>
    </tr>
    <tr>
      <th>131</th>
      <td>03-16</td>
      <td>硕士</td>
      <td>37500</td>
      <td>高</td>
    </tr>
    <tr>
      <th>132</th>
      <td>03-16</td>
      <td>本科</td>
      <td>30000</td>
      <td>高</td>
    </tr>
    <tr>
      <th>133</th>
      <td>03-16</td>
      <td>本科</td>
      <td>19000</td>
      <td>中</td>
    </tr>
    <tr>
      <th>134</th>
      <td>03-16</td>
      <td>本科</td>
      <td>30000</td>
      <td>高</td>
    </tr>
  </tbody>
</table>
<p>135 rows × 4 columns</p>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.sort_values(<span class="string">&#x27;salary&#x27;</span>, ascending=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>createTime</th>
      <th>education</th>
      <th>salary</th>
      <th>categories</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>53</th>
      <td>03-16</td>
      <td>本科</td>
      <td>45000</td>
      <td>高</td>
    </tr>
    <tr>
      <th>37</th>
      <td>03-16</td>
      <td>本科</td>
      <td>40000</td>
      <td>高</td>
    </tr>
    <tr>
      <th>101</th>
      <td>03-16</td>
      <td>本科</td>
      <td>37500</td>
      <td>高</td>
    </tr>
    <tr>
      <th>16</th>
      <td>03-16</td>
      <td>本科</td>
      <td>37500</td>
      <td>高</td>
    </tr>
    <tr>
      <th>131</th>
      <td>03-16</td>
      <td>硕士</td>
      <td>37500</td>
      <td>高</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>123</th>
      <td>03-16</td>
      <td>本科</td>
      <td>4500</td>
      <td>低</td>
    </tr>
    <tr>
      <th>126</th>
      <td>03-16</td>
      <td>本科</td>
      <td>4000</td>
      <td>低</td>
    </tr>
    <tr>
      <th>110</th>
      <td>03-16</td>
      <td>本科</td>
      <td>4000</td>
      <td>低</td>
    </tr>
    <tr>
      <th>96</th>
      <td>03-16</td>
      <td>不限</td>
      <td>3500</td>
      <td>低</td>
    </tr>
    <tr>
      <th>113</th>
      <td>03-16</td>
      <td>本科</td>
      <td>3500</td>
      <td>低</td>
    </tr>
  </tbody>
</table>
<p>135 rows × 4 columns</p>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[<span class="number">32</span>]</span><br></pre></td></tr></table></figure>
<pre><code>createTime    03-16
education        硕士
salary        22500
categories        高
Name: 32, dtype: object
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.median(df[<span class="string">&#x27;salary&#x27;</span>])</span><br></pre></td></tr></table></figure>
<pre><code>17500.0
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.salary.plot(kind=<span class="string">&#x27;hist&#x27;</span>)</span><br></pre></td></tr></table></figure>
<pre><code>&lt;AxesSubplot:ylabel=&#39;Frequency&#39;&gt;
</code></pre><p><img src="/img/pandas_files/pandas_34_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># KED Kernel Density Estimation</span></span><br><span class="line">df.salary.plot(kind=<span class="string">&#x27;kde&#x27;</span>)</span><br></pre></td></tr></table></figure>
<pre><code>&lt;AxesSubplot:ylabel=&#39;Density&#39;&gt;
</code></pre><p><img src="/img/pandas_files/pandas_35_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">del</span> df[<span class="string">&#x27;categories&#x27;</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>createTime</th>
      <th>education</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>03-16</td>
      <td>本科</td>
      <td>27500</td>
    </tr>
    <tr>
      <th>1</th>
      <td>03-16</td>
      <td>本科</td>
      <td>30000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>03-16</td>
      <td>不限</td>
      <td>27500</td>
    </tr>
    <tr>
      <th>3</th>
      <td>03-16</td>
      <td>本科</td>
      <td>16500</td>
    </tr>
    <tr>
      <th>4</th>
      <td>03-16</td>
      <td>本科</td>
      <td>15000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>130</th>
      <td>03-16</td>
      <td>本科</td>
      <td>14000</td>
    </tr>
    <tr>
      <th>131</th>
      <td>03-16</td>
      <td>硕士</td>
      <td>37500</td>
    </tr>
    <tr>
      <th>132</th>
      <td>03-16</td>
      <td>本科</td>
      <td>30000</td>
    </tr>
    <tr>
      <th>133</th>
      <td>03-16</td>
      <td>本科</td>
      <td>19000</td>
    </tr>
    <tr>
      <th>134</th>
      <td>03-16</td>
      <td>本科</td>
      <td>30000</td>
    </tr>
  </tbody>
</table>
<p>135 rows × 3 columns</p>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.salary.<span class="built_in">max</span>() - df.salary.<span class="built_in">min</span>()</span><br></pre></td></tr></table></figure>
<pre><code>41500
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.concat([df[:<span class="number">1</span>], df[-<span class="number">2</span>:-<span class="number">1</span>]])</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>createTime</th>
      <th>education</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>03-16</td>
      <td>本科</td>
      <td>27500</td>
    </tr>
    <tr>
      <th>133</th>
      <td>03-16</td>
      <td>本科</td>
      <td>19000</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.append(df.loc[<span class="number">7</span>])</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>createTime</th>
      <th>education</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>03-16</td>
      <td>本科</td>
      <td>27500</td>
    </tr>
    <tr>
      <th>1</th>
      <td>03-16</td>
      <td>本科</td>
      <td>30000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>03-16</td>
      <td>不限</td>
      <td>27500</td>
    </tr>
    <tr>
      <th>3</th>
      <td>03-16</td>
      <td>本科</td>
      <td>16500</td>
    </tr>
    <tr>
      <th>4</th>
      <td>03-16</td>
      <td>本科</td>
      <td>15000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>131</th>
      <td>03-16</td>
      <td>硕士</td>
      <td>37500</td>
    </tr>
    <tr>
      <th>132</th>
      <td>03-16</td>
      <td>本科</td>
      <td>30000</td>
    </tr>
    <tr>
      <th>133</th>
      <td>03-16</td>
      <td>本科</td>
      <td>19000</td>
    </tr>
    <tr>
      <th>134</th>
      <td>03-16</td>
      <td>本科</td>
      <td>30000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>03-16</td>
      <td>本科</td>
      <td>12500</td>
    </tr>
  </tbody>
</table>
<p>136 rows × 3 columns</p>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.set_index(<span class="string">&quot;createTime&quot;</span>)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>education</th>
      <th>salary</th>
    </tr>
    <tr>
      <th>createTime</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>03-16</th>
      <td>本科</td>
      <td>27500</td>
    </tr>
    <tr>
      <th>03-16</th>
      <td>本科</td>
      <td>30000</td>
    </tr>
    <tr>
      <th>03-16</th>
      <td>不限</td>
      <td>27500</td>
    </tr>
    <tr>
      <th>03-16</th>
      <td>本科</td>
      <td>16500</td>
    </tr>
    <tr>
      <th>03-16</th>
      <td>本科</td>
      <td>15000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>03-16</th>
      <td>本科</td>
      <td>14000</td>
    </tr>
    <tr>
      <th>03-16</th>
      <td>硕士</td>
      <td>37500</td>
    </tr>
    <tr>
      <th>03-16</th>
      <td>本科</td>
      <td>30000</td>
    </tr>
    <tr>
      <th>03-16</th>
      <td>本科</td>
      <td>19000</td>
    </tr>
    <tr>
      <th>03-16</th>
      <td>本科</td>
      <td>30000</td>
    </tr>
  </tbody>
</table>
<p>135 rows × 2 columns</p>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_r = pd.DataFrame(np.random.randint(<span class="number">1</span>, <span class="number">10</span>, <span class="number">135</span>), columns=[<span class="string">&#x27;random&#x27;</span>])</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.concat([df, df_r], axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;sub&#x27;</span>] = df.salary - df.random</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>createTime</th>
      <th>education</th>
      <th>salary</th>
      <th>random</th>
      <th>sub</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>03-16</td>
      <td>本科</td>
      <td>27500</td>
      <td>2</td>
      <td>27498</td>
    </tr>
    <tr>
      <th>1</th>
      <td>03-16</td>
      <td>本科</td>
      <td>30000</td>
      <td>6</td>
      <td>29994</td>
    </tr>
    <tr>
      <th>2</th>
      <td>03-16</td>
      <td>不限</td>
      <td>27500</td>
      <td>5</td>
      <td>27495</td>
    </tr>
    <tr>
      <th>3</th>
      <td>03-16</td>
      <td>本科</td>
      <td>16500</td>
      <td>3</td>
      <td>16497</td>
    </tr>
    <tr>
      <th>4</th>
      <td>03-16</td>
      <td>本科</td>
      <td>15000</td>
      <td>8</td>
      <td>14992</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>130</th>
      <td>03-16</td>
      <td>本科</td>
      <td>14000</td>
      <td>1</td>
      <td>13999</td>
    </tr>
    <tr>
      <th>131</th>
      <td>03-16</td>
      <td>硕士</td>
      <td>37500</td>
      <td>5</td>
      <td>37495</td>
    </tr>
    <tr>
      <th>132</th>
      <td>03-16</td>
      <td>本科</td>
      <td>30000</td>
      <td>8</td>
      <td>29992</td>
    </tr>
    <tr>
      <th>133</th>
      <td>03-16</td>
      <td>本科</td>
      <td>19000</td>
      <td>7</td>
      <td>18993</td>
    </tr>
    <tr>
      <th>134</th>
      <td>03-16</td>
      <td>本科</td>
      <td>30000</td>
      <td>6</td>
      <td>29994</td>
    </tr>
  </tbody>
</table>
<p>135 rows × 5 columns</p>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.isna().<span class="built_in">sum</span>()</span><br></pre></td></tr></table></figure>
<pre><code>createTime    0
education     0
salary        0
random        0
sub           0
dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.isna().values.<span class="built_in">any</span>()</span><br></pre></td></tr></table></figure>
<pre><code>False
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.salary.astype(<span class="built_in">float</span>)</span><br></pre></td></tr></table></figure>
<pre><code>0      27500.0
1      30000.0
2      27500.0
3      16500.0
4      15000.0
        ...   
130    14000.0
131    37500.0
132    30000.0
133    19000.0
134    30000.0
Name: salary, Length: 135, dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">len</span>(df[df.salary &gt; <span class="number">10000</span>].salary)</span><br></pre></td></tr></table></figure>
<pre><code>119
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df.education.value_counts()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<pre><code>本科    119
硕士      7
不限      5
大专      4
Name: education, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.education.unique()</span><br></pre></td></tr></table></figure>
<pre><code>array([&#39;本科&#39;, &#39;不限&#39;, &#39;硕士&#39;, &#39;大专&#39;], dtype=object)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.education.nunique()</span><br></pre></td></tr></table></figure>
<pre><code>4
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[(df.salary + df[<span class="string">&#x27;sub&#x27;</span>]) &gt; <span class="number">60000</span>].tail(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>createTime</th>
      <th>education</th>
      <th>salary</th>
      <th>random</th>
      <th>sub</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>92</th>
      <td>03-16</td>
      <td>本科</td>
      <td>35000</td>
      <td>6</td>
      <td>34994</td>
    </tr>
    <tr>
      <th>101</th>
      <td>03-16</td>
      <td>本科</td>
      <td>37500</td>
      <td>4</td>
      <td>37496</td>
    </tr>
    <tr>
      <th>131</th>
      <td>03-16</td>
      <td>硕士</td>
      <td>37500</td>
      <td>5</td>
      <td>37495</td>
    </tr>
  </tbody>
</table>
</div>



<h1 id="金融数据处理"><a href="#金融数据处理" class="headerlink" title="金融数据处理"></a>金融数据处理</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_excel(<span class="string">&#x27;./600000.SH.xls&#x27;</span>)</span><br></pre></td></tr></table></figure>
<pre><code>WARNING *** OLE2 inconsistency: SSCS size is 0 but SSAT size is non-zero
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.head(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>代码</th>
      <th>简称</th>
      <th>日期</th>
      <th>前收盘价(元)</th>
      <th>开盘价(元)</th>
      <th>最高价(元)</th>
      <th>最低价(元)</th>
      <th>收盘价(元)</th>
      <th>成交量(股)</th>
      <th>成交金额(元)</th>
      <th>涨跌(元)</th>
      <th>涨跌幅(%)</th>
      <th>均价(元)</th>
      <th>换手率(%)</th>
      <th>A股流通市值(元)</th>
      <th>总市值(元)</th>
      <th>A股流通股本(股)</th>
      <th>市盈率</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>600000.SH</td>
      <td>浦发银行</td>
      <td>2016-01-04</td>
      <td>16.1356</td>
      <td>16.1444</td>
      <td>16.1444</td>
      <td>15.4997</td>
      <td>15.7205</td>
      <td>42240610</td>
      <td>754425783</td>
      <td>-0.4151</td>
      <td>-2.5725</td>
      <td>17.8602</td>
      <td>0.2264</td>
      <td>3.320318e+11</td>
      <td>3.320318e+11</td>
      <td>1.865347e+10</td>
      <td>6.5614</td>
    </tr>
    <tr>
      <th>1</th>
      <td>600000.SH</td>
      <td>浦发银行</td>
      <td>2016-01-05</td>
      <td>15.7205</td>
      <td>15.4644</td>
      <td>15.9501</td>
      <td>15.3672</td>
      <td>15.8618</td>
      <td>58054793</td>
      <td>1034181474</td>
      <td>0.1413</td>
      <td>0.8989</td>
      <td>17.8139</td>
      <td>0.3112</td>
      <td>3.350163e+11</td>
      <td>3.350163e+11</td>
      <td>1.865347e+10</td>
      <td>6.6204</td>
    </tr>
    <tr>
      <th>2</th>
      <td>600000.SH</td>
      <td>浦发银行</td>
      <td>2016-01-06</td>
      <td>15.8618</td>
      <td>15.8088</td>
      <td>16.0208</td>
      <td>15.6234</td>
      <td>15.9855</td>
      <td>46772653</td>
      <td>838667398</td>
      <td>0.1236</td>
      <td>0.7795</td>
      <td>17.9307</td>
      <td>0.2507</td>
      <td>3.376278e+11</td>
      <td>3.376278e+11</td>
      <td>1.865347e+10</td>
      <td>6.6720</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.isna().<span class="built_in">sum</span>()</span><br></pre></td></tr></table></figure>
<pre><code>代码           1
简称           2
日期           2
前收盘价(元)      2
开盘价(元)       2
最高价(元)       2
最低价(元)       2
收盘价(元)       2
成交量(股)       2
成交金额(元)      2
涨跌(元)        2
涨跌幅(%)       2
均价(元)        2
换手率(%)       2
A股流通市值(元)    2
总市值(元)       2
A股流通股本(股)    2
市盈率          2
dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[df[<span class="string">&#x27;日期&#x27;</span>].isna()]</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>代码</th>
      <th>简称</th>
      <th>日期</th>
      <th>前收盘价(元)</th>
      <th>开盘价(元)</th>
      <th>最高价(元)</th>
      <th>最低价(元)</th>
      <th>收盘价(元)</th>
      <th>成交量(股)</th>
      <th>成交金额(元)</th>
      <th>涨跌(元)</th>
      <th>涨跌幅(%)</th>
      <th>均价(元)</th>
      <th>换手率(%)</th>
      <th>A股流通市值(元)</th>
      <th>总市值(元)</th>
      <th>A股流通股本(股)</th>
      <th>市盈率</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>327</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaT</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>328</th>
      <td>数据来源：Wind资讯</td>
      <td>NaN</td>
      <td>NaT</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data = df</span><br><span class="line"><span class="keyword">for</span> columname <span class="keyword">in</span> data.columns:</span><br><span class="line">    <span class="keyword">if</span> data[columname].count() != <span class="built_in">len</span>(data):</span><br><span class="line">        loc = data[columname][data[columname].isnull().values==<span class="literal">True</span>].index.tolist()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;列名：&quot;&#123;&#125;&quot;, 第&#123;&#125;行位置有缺失值&#x27;</span>.<span class="built_in">format</span>(columname,loc))</span><br></pre></td></tr></table></figure>
<pre><code>列名：&quot;代码&quot;, 第[327]行位置有缺失值
列名：&quot;简称&quot;, 第[327, 328]行位置有缺失值
列名：&quot;日期&quot;, 第[327, 328]行位置有缺失值
列名：&quot;前收盘价(元)&quot;, 第[327, 328]行位置有缺失值
列名：&quot;开盘价(元)&quot;, 第[327, 328]行位置有缺失值
列名：&quot;最高价(元)&quot;, 第[327, 328]行位置有缺失值
列名：&quot;最低价(元)&quot;, 第[327, 328]行位置有缺失值
列名：&quot;收盘价(元)&quot;, 第[327, 328]行位置有缺失值
列名：&quot;成交量(股)&quot;, 第[327, 328]行位置有缺失值
列名：&quot;成交金额(元)&quot;, 第[327, 328]行位置有缺失值
列名：&quot;涨跌(元)&quot;, 第[327, 328]行位置有缺失值
列名：&quot;涨跌幅(%)&quot;, 第[327, 328]行位置有缺失值
列名：&quot;均价(元)&quot;, 第[327, 328]行位置有缺失值
列名：&quot;换手率(%)&quot;, 第[327, 328]行位置有缺失值
列名：&quot;A股流通市值(元)&quot;, 第[327, 328]行位置有缺失值
列名：&quot;总市值(元)&quot;, 第[327, 328]行位置有缺失值
列名：&quot;A股流通股本(股)&quot;, 第[327, 328]行位置有缺失值
列名：&quot;市盈率&quot;, 第[327, 328]行位置有缺失值
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.dropna(axis=<span class="number">0</span>, how=<span class="string">&#x27;any&#x27;</span>, inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># df = df.set_index(&#x27;日期&#x27;)</span></span><br><span class="line">df[<span class="string">&#x27;收盘价(元)&#x27;</span>].plot(kind=<span class="string">&#x27;line&#x27;</span>)</span><br></pre></td></tr></table></figure>
<pre><code>&lt;AxesSubplot:&gt;
</code></pre><p><img src="/img/pandas_files/pandas_61_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[[<span class="string">&#x27;收盘价(元)&#x27;</span>, <span class="string">&#x27;开盘价(元)&#x27;</span>]].plot(kind=<span class="string">&#x27;line&#x27;</span>)</span><br></pre></td></tr></table></figure>
<pre><code>&lt;AxesSubplot:&gt;



/Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:238: RuntimeWarning: Glyph 25910 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:238: RuntimeWarning: Glyph 30424 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:238: RuntimeWarning: Glyph 20215 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:238: RuntimeWarning: Glyph 20803 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:238: RuntimeWarning: Glyph 24320 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:201: RuntimeWarning: Glyph 25910 missing from current font.
  font.set_text(s, 0, flags=flags)
/Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:201: RuntimeWarning: Glyph 30424 missing from current font.
  font.set_text(s, 0, flags=flags)
/Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:201: RuntimeWarning: Glyph 20215 missing from current font.
  font.set_text(s, 0, flags=flags)
/Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:201: RuntimeWarning: Glyph 20803 missing from current font.
  font.set_text(s, 0, flags=flags)
/Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:201: RuntimeWarning: Glyph 24320 missing from current font.
  font.set_text(s, 0, flags=flags)
</code></pre><p><img src="/img/pandas_files/pandas_62_2.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;涨跌幅(%)&#x27;</span>].plot(kind=<span class="string">&#x27;hist&#x27;</span>)</span><br></pre></td></tr></table></figure>
<pre><code>&lt;AxesSubplot:ylabel=&#39;Frequency&#39;&gt;
</code></pre><p><img src="/img/pandas_files/pandas_63_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;涨跌幅(%)&#x27;</span>].plot(kind=<span class="string">&#x27;hist&#x27;</span>, bins=<span class="number">30</span>)</span><br></pre></td></tr></table></figure>
<pre><code>&lt;AxesSubplot:ylabel=&#39;Frequency&#39;&gt;
</code></pre><p><img src="/img/pandas_files/pandas_64_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">temp = pd.DataFrame(columns = data.columns.to_list())</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">type</span>(data.iloc[i,<span class="number">13</span>]) != <span class="built_in">float</span>:</span><br><span class="line">        temp = temp.append(data.loc[i])</span><br><span class="line">temp.head(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>代码</th>
      <th>简称</th>
      <th>日期</th>
      <th>前收盘价(元)</th>
      <th>开盘价(元)</th>
      <th>最高价(元)</th>
      <th>最低价(元)</th>
      <th>收盘价(元)</th>
      <th>成交量(股)</th>
      <th>成交金额(元)</th>
      <th>涨跌(元)</th>
      <th>涨跌幅(%)</th>
      <th>均价(元)</th>
      <th>换手率(%)</th>
      <th>A股流通市值(元)</th>
      <th>总市值(元)</th>
      <th>A股流通股本(股)</th>
      <th>市盈率</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>26</th>
      <td>600000.SH</td>
      <td>浦发银行</td>
      <td>2016-02-16</td>
      <td>16.2946</td>
      <td>16.2946</td>
      <td>16.2946</td>
      <td>16.2946</td>
      <td>16.2946</td>
      <td>--</td>
      <td>--</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>--</td>
      <td>--</td>
      <td>3.441565e+11</td>
      <td>3.441565e+11</td>
      <td>1.865347e+10</td>
      <td>6.801</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">i = df[df[<span class="string">&#x27;换手率(%)&#x27;</span>].isin([<span class="string">&#x27;--&#x27;</span>])].index</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">i</span><br></pre></td></tr></table></figure>
<pre><code>Int64Index([26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42,
            43],
           dtype=&#39;int64&#39;)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = df.drop(index=i)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;换手率(%)&#x27;</span>].plot(kind=<span class="string">&#x27;kde&#x27;</span>)</span><br></pre></td></tr></table></figure>
<pre><code>&lt;AxesSubplot:ylabel=&#39;Density&#39;&gt;
</code></pre><p><img src="/img/pandas_files/pandas_69_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;收盘价(元)&#x27;</span>].diff()</span><br></pre></td></tr></table></figure>
<pre><code>0         NaN
1      0.1413
2      0.1237
3     -0.5211
4     -0.0177
        ...  
322   -0.0800
323   -0.1000
324   -0.0600
325   -0.0600
326   -0.1000
Name: 收盘价(元), Length: 309, dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;收盘价(元)&#x27;</span>] - df[<span class="string">&#x27;收盘价(元)&#x27;</span>].shift(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<pre><code>0         NaN
1      0.1413
2      0.1237
3     -0.5211
4     -0.0177
        ...  
322   -0.0800
323   -0.1000
324   -0.0600
325   -0.0600
326   -0.1000
Name: 收盘价(元), Length: 309, dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;收盘价(元)&#x27;</span>].pct_change()</span><br></pre></td></tr></table></figure>
<pre><code>0           NaN
1      0.008988
2      0.007799
3     -0.032598
4     -0.001145
         ...   
322   -0.005277
323   -0.006631
324   -0.004005
325   -0.004021
326   -0.006729
Name: 收盘价(元), Length: 309, dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = data.set_index(<span class="string">&#x27;日期&#x27;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;收盘价(元)&#x27;</span>].rolling(<span class="number">5</span>).mean()</span><br></pre></td></tr></table></figure>
<pre><code>日期
2016-01-04         NaN
2016-01-05         NaN
2016-01-06         NaN
2016-01-07         NaN
2016-01-08    15.69578
                ...   
2017-05-03    15.14200
2017-05-04    15.12800
2017-05-05    15.07000
2017-05-08    15.00000
2017-05-09    14.92000
Name: 收盘价(元), Length: 327, dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;收盘价(元)&#x27;</span>].rolling(<span class="number">5</span>).<span class="built_in">sum</span>()</span><br></pre></td></tr></table></figure>
<pre><code>日期
2016-01-04        NaN
2016-01-05        NaN
2016-01-06        NaN
2016-01-07        NaN
2016-01-08    78.4789
               ...   
2017-05-03    75.7100
2017-05-04    75.6400
2017-05-05    75.3500
2017-05-08    75.0000
2017-05-09    74.6000
Name: 收盘价(元), Length: 327, dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">temp = pd.DataFrame()</span><br><span class="line">temp[<span class="string">&#x27;m5&#x27;</span>] = df[<span class="string">&#x27;收盘价(元)&#x27;</span>].rolling(<span class="number">5</span>).mean()</span><br><span class="line">temp[<span class="string">&#x27;m20&#x27;</span>] = df[<span class="string">&#x27;收盘价(元)&#x27;</span>].rolling(<span class="number">20</span>).mean()</span><br><span class="line">temp.plot()</span><br></pre></td></tr></table></figure>
<pre><code>&lt;AxesSubplot:xlabel=&#39;日期&#39;&gt;



/Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:238: RuntimeWarning: Glyph 26085 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:238: RuntimeWarning: Glyph 26399 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:201: RuntimeWarning: Glyph 26085 missing from current font.
  font.set_text(s, 0, flags=flags)
/Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:201: RuntimeWarning: Glyph 26399 missing from current font.
  font.set_text(s, 0, flags=flags)
</code></pre><p><img src="/img/pandas_files/pandas_76_2.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;收盘价(元)&#x27;</span>].resample(rule=<span class="string">&#x27;W&#x27;</span>).<span class="built_in">max</span>()</span><br></pre></td></tr></table></figure>
<pre><code>日期
2016-01-10    15.9855
2016-01-17    15.8265
2016-01-24    15.6940
2016-01-31    15.0405
2016-02-07    16.2328
               ...   
2017-04-16    15.9700
2017-04-23    15.5600
2017-04-30    15.2100
2017-05-07    15.1600
2017-05-14    14.8600
Freq: W-SUN, Name: 收盘价(元), Length: 71, dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;收盘价(元)&#x27;</span>].plot()</span><br><span class="line">df[<span class="string">&#x27;收盘价(元)&#x27;</span>].resample(<span class="string">&#x27;7D&#x27;</span>).<span class="built_in">max</span>().plot()</span><br></pre></td></tr></table></figure>
<pre><code>&lt;AxesSubplot:xlabel=&#39;日期&#39;&gt;



/Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:238: RuntimeWarning: Glyph 26085 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:238: RuntimeWarning: Glyph 26399 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:201: RuntimeWarning: Glyph 26085 missing from current font.
  font.set_text(s, 0, flags=flags)
/Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:201: RuntimeWarning: Glyph 26399 missing from current font.
  font.set_text(s, 0, flags=flags)
</code></pre><p><img src="/img/pandas_files/pandas_78_2.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data[<span class="string">&#x27;开盘价(元)&#x27;</span>].expanding(min_periods=<span class="number">1</span>).mean()</span><br></pre></td></tr></table></figure>
<pre><code>0      16.144400
1      15.804400
2      15.805867
3      15.784525
4      15.761120
         ...    
322    16.055594
323    16.052552
324    16.049159
325    16.045266
326    16.041122
Name: 开盘价(元), Length: 327, dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;expanding Open mean&#x27;</span>]=df[<span class="string">&#x27;开盘价(元)&#x27;</span>].expanding(min_periods=<span class="number">1</span>).mean()</span><br><span class="line">df[[<span class="string">&#x27;开盘价(元)&#x27;</span>, <span class="string">&#x27;expanding Open mean&#x27;</span>]].plot(figsize=(<span class="number">16</span>, <span class="number">6</span>))</span><br></pre></td></tr></table></figure>
<pre><code>&lt;AxesSubplot:xlabel=&#39;日期&#39;&gt;



/Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:238: RuntimeWarning: Glyph 26085 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:238: RuntimeWarning: Glyph 26399 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:238: RuntimeWarning: Glyph 24320 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:238: RuntimeWarning: Glyph 30424 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:238: RuntimeWarning: Glyph 20215 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:238: RuntimeWarning: Glyph 20803 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:201: RuntimeWarning: Glyph 26085 missing from current font.
  font.set_text(s, 0, flags=flags)
/Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:201: RuntimeWarning: Glyph 26399 missing from current font.
  font.set_text(s, 0, flags=flags)
/Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:201: RuntimeWarning: Glyph 24320 missing from current font.
  font.set_text(s, 0, flags=flags)
/Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:201: RuntimeWarning: Glyph 30424 missing from current font.
  font.set_text(s, 0, flags=flags)
/Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:201: RuntimeWarning: Glyph 20215 missing from current font.
  font.set_text(s, 0, flags=flags)
/Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:201: RuntimeWarning: Glyph 20803 missing from current font.
  font.set_text(s, 0, flags=flags)
</code></pre><p><img src="/img/pandas_files/pandas_80_2.png" alt="png"></p>
<h1 id="pandas-amp-numpy"><a href="#pandas-amp-numpy" class="headerlink" title="pandas &amp; numpy"></a>pandas &amp; numpy</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 随机</span></span><br><span class="line">df1 = pd.DataFrame(np.random.randint(<span class="number">0</span>, <span class="number">100</span>, <span class="number">20</span>))</span><br><span class="line"><span class="comment"># 等步长</span></span><br><span class="line">df2 = pd.DataFrame(np.arange(<span class="number">0</span>, <span class="number">100</span>, <span class="number">5</span>))</span><br><span class="line"><span class="comment"># 正态分布</span></span><br><span class="line">df3 = pd.DataFrame(np.random.normal(<span class="number">0</span>, <span class="number">1</span>, <span class="number">20</span>))</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df3.plot(kind=<span class="string">&#x27;hist&#x27;</span>)</span><br></pre></td></tr></table></figure>
<pre><code>&lt;AxesSubplot:ylabel=&#39;Frequency&#39;&gt;
</code></pre><p><img src="/img/pandas_files/pandas_83_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.concat([df1,df2,df3],ignore_index=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.concat([df1,df2,df3], axis=<span class="number">1</span>, ignore_index=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>25</td>
      <td>0</td>
      <td>0.573071</td>
    </tr>
    <tr>
      <th>1</th>
      <td>86</td>
      <td>5</td>
      <td>-0.474405</td>
    </tr>
    <tr>
      <th>2</th>
      <td>34</td>
      <td>10</td>
      <td>-0.910378</td>
    </tr>
    <tr>
      <th>3</th>
      <td>18</td>
      <td>15</td>
      <td>0.713983</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9</td>
      <td>20</td>
      <td>0.732289</td>
    </tr>
    <tr>
      <th>5</th>
      <td>67</td>
      <td>25</td>
      <td>-2.087864</td>
    </tr>
    <tr>
      <th>6</th>
      <td>5</td>
      <td>30</td>
      <td>-1.126019</td>
    </tr>
    <tr>
      <th>7</th>
      <td>51</td>
      <td>35</td>
      <td>-1.512201</td>
    </tr>
    <tr>
      <th>8</th>
      <td>3</td>
      <td>40</td>
      <td>-0.697655</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>45</td>
      <td>-1.082615</td>
    </tr>
    <tr>
      <th>10</th>
      <td>59</td>
      <td>50</td>
      <td>-0.809815</td>
    </tr>
    <tr>
      <th>11</th>
      <td>28</td>
      <td>55</td>
      <td>-0.158042</td>
    </tr>
    <tr>
      <th>12</th>
      <td>21</td>
      <td>60</td>
      <td>-1.753240</td>
    </tr>
    <tr>
      <th>13</th>
      <td>96</td>
      <td>65</td>
      <td>0.687153</td>
    </tr>
    <tr>
      <th>14</th>
      <td>77</td>
      <td>70</td>
      <td>-1.534696</td>
    </tr>
    <tr>
      <th>15</th>
      <td>25</td>
      <td>75</td>
      <td>1.169113</td>
    </tr>
    <tr>
      <th>16</th>
      <td>26</td>
      <td>80</td>
      <td>-0.015986</td>
    </tr>
    <tr>
      <th>17</th>
      <td>52</td>
      <td>85</td>
      <td>0.517278</td>
    </tr>
    <tr>
      <th>18</th>
      <td>60</td>
      <td>90</td>
      <td>1.045848</td>
    </tr>
    <tr>
      <th>19</th>
      <td>35</td>
      <td>95</td>
      <td>0.856043</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.describe()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>39.350000</td>
      <td>47.500000</td>
      <td>-0.293407</td>
    </tr>
    <tr>
      <th>std</th>
      <td>27.642978</td>
      <td>29.580399</td>
      <td>1.034218</td>
    </tr>
    <tr>
      <th>min</th>
      <td>3.000000</td>
      <td>0.000000</td>
      <td>-2.087864</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>20.250000</td>
      <td>23.750000</td>
      <td>-1.093466</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>31.000000</td>
      <td>47.500000</td>
      <td>-0.316223</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>59.250000</td>
      <td>71.250000</td>
      <td>0.693860</td>
    </tr>
    <tr>
      <th>max</th>
      <td>96.000000</td>
      <td>95.000000</td>
      <td>1.169113</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.columns = [<span class="string">&#x27;col1&#x27;</span>, <span class="string">&#x27;col2&#x27;</span>, <span class="string">&#x27;col3&#x27;</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;col1&#x27;</span>][~df[<span class="string">&#x27;col1&#x27;</span>].isin(df[<span class="string">&#x27;col2&#x27;</span>])]</span><br></pre></td></tr></table></figure>
<pre><code>1     86
2     34
3     18
4      9
5     67
7     51
8      3
10    59
11    28
12    21
13    96
14    77
16    26
17    52
Name: col1, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;col1&#x27;</span>].append(df[<span class="string">&#x27;col2&#x27;</span>]).value_counts().head(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<pre><code>25    3
60    2
35    2
dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.where(df[<span class="string">&#x27;col1&#x27;</span>] % <span class="number">5</span>==<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<pre><code>(array([ 0,  6,  9, 15, 18, 19]),)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[df.columns[::-<span class="number">1</span>]]</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>col3</th>
      <th>col2</th>
      <th>col1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.573071</td>
      <td>0</td>
      <td>25</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.474405</td>
      <td>5</td>
      <td>86</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.910378</td>
      <td>10</td>
      <td>34</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.713983</td>
      <td>15</td>
      <td>18</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.732289</td>
      <td>20</td>
      <td>9</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-2.087864</td>
      <td>25</td>
      <td>67</td>
    </tr>
    <tr>
      <th>6</th>
      <td>-1.126019</td>
      <td>30</td>
      <td>5</td>
    </tr>
    <tr>
      <th>7</th>
      <td>-1.512201</td>
      <td>35</td>
      <td>51</td>
    </tr>
    <tr>
      <th>8</th>
      <td>-0.697655</td>
      <td>40</td>
      <td>3</td>
    </tr>
    <tr>
      <th>9</th>
      <td>-1.082615</td>
      <td>45</td>
      <td>10</td>
    </tr>
    <tr>
      <th>10</th>
      <td>-0.809815</td>
      <td>50</td>
      <td>59</td>
    </tr>
    <tr>
      <th>11</th>
      <td>-0.158042</td>
      <td>55</td>
      <td>28</td>
    </tr>
    <tr>
      <th>12</th>
      <td>-1.753240</td>
      <td>60</td>
      <td>21</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0.687153</td>
      <td>65</td>
      <td>96</td>
    </tr>
    <tr>
      <th>14</th>
      <td>-1.534696</td>
      <td>70</td>
      <td>77</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1.169113</td>
      <td>75</td>
      <td>25</td>
    </tr>
    <tr>
      <th>16</th>
      <td>-0.015986</td>
      <td>80</td>
      <td>26</td>
    </tr>
    <tr>
      <th>17</th>
      <td>0.517278</td>
      <td>85</td>
      <td>52</td>
    </tr>
    <tr>
      <th>18</th>
      <td>1.045848</td>
      <td>90</td>
      <td>60</td>
    </tr>
    <tr>
      <th>19</th>
      <td>0.856043</td>
      <td>95</td>
      <td>35</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;col1&#x27;</span>].take([<span class="number">1</span>,<span class="number">10</span>,<span class="number">15</span>])</span><br></pre></td></tr></table></figure>
<pre><code>1     86
10    59
15    25
Name: col1, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tem = np.diff(np.sign(np.diff(df[<span class="string">&#x27;col1&#x27;</span>])))</span><br><span class="line">np.where(tem == -<span class="number">2</span>)[<span class="number">0</span>] + <span class="number">1</span></span><br></pre></td></tr></table></figure>
<pre><code>array([ 1,  5,  7, 10, 13, 18])
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.mean(axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<pre><code>0      8.524357
1     30.175198
2     14.363207
3     11.237994
4      9.910763
5     29.970712
6     11.291327
7     28.162600
8     14.100782
9     17.972462
10    36.063395
11    27.613986
12    26.415587
13    53.895718
14    48.488435
15    33.723038
16    35.328005
17    45.839093
18    50.348616
19    43.618681
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.convolve(df[<span class="string">&#x27;col2&#x27;</span>], np.ones(<span class="number">3</span>)/<span class="number">3</span>, mode=<span class="string">&#x27;valid&#x27;</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([ 5., 10., 15., 20., 25., 30., 35., 40., 45., 50., 55., 60., 65.,
       70., 75., 80., 85., 90.])
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;col2&#x27;</span>].rolling(window=<span class="number">3</span>).mean()</span><br></pre></td></tr></table></figure>
<pre><code>0      NaN
1      NaN
2      5.0
3     10.0
4     15.0
5     20.0
6     25.0
7     30.0
8     35.0
9     40.0
10    45.0
11    50.0
12    55.0
13    60.0
14    65.0
15    70.0
16    75.0
17    80.0
18    85.0
19    90.0
Name: col2, dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.sort_values(<span class="string">&quot;col3&quot;</span>)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>col1</th>
      <th>col2</th>
      <th>col3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>67</td>
      <td>25</td>
      <td>-2.087864</td>
    </tr>
    <tr>
      <th>12</th>
      <td>21</td>
      <td>60</td>
      <td>-1.753240</td>
    </tr>
    <tr>
      <th>14</th>
      <td>77</td>
      <td>70</td>
      <td>-1.534696</td>
    </tr>
    <tr>
      <th>7</th>
      <td>51</td>
      <td>35</td>
      <td>-1.512201</td>
    </tr>
    <tr>
      <th>6</th>
      <td>5</td>
      <td>30</td>
      <td>-1.126019</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>45</td>
      <td>-1.082615</td>
    </tr>
    <tr>
      <th>2</th>
      <td>34</td>
      <td>10</td>
      <td>-0.910378</td>
    </tr>
    <tr>
      <th>10</th>
      <td>59</td>
      <td>50</td>
      <td>-0.809815</td>
    </tr>
    <tr>
      <th>8</th>
      <td>3</td>
      <td>40</td>
      <td>-0.697655</td>
    </tr>
    <tr>
      <th>1</th>
      <td>86</td>
      <td>5</td>
      <td>-0.474405</td>
    </tr>
    <tr>
      <th>11</th>
      <td>28</td>
      <td>55</td>
      <td>-0.158042</td>
    </tr>
    <tr>
      <th>16</th>
      <td>26</td>
      <td>80</td>
      <td>-0.015986</td>
    </tr>
    <tr>
      <th>17</th>
      <td>52</td>
      <td>85</td>
      <td>0.517278</td>
    </tr>
    <tr>
      <th>0</th>
      <td>25</td>
      <td>0</td>
      <td>0.573071</td>
    </tr>
    <tr>
      <th>13</th>
      <td>96</td>
      <td>65</td>
      <td>0.687153</td>
    </tr>
    <tr>
      <th>3</th>
      <td>18</td>
      <td>15</td>
      <td>0.713983</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9</td>
      <td>20</td>
      <td>0.732289</td>
    </tr>
    <tr>
      <th>19</th>
      <td>35</td>
      <td>95</td>
      <td>0.856043</td>
    </tr>
    <tr>
      <th>18</th>
      <td>60</td>
      <td>90</td>
      <td>1.045848</td>
    </tr>
    <tr>
      <th>15</th>
      <td>25</td>
      <td>75</td>
      <td>1.169113</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.col1[df[<span class="string">&#x27;col1&#x27;</span>] &gt; <span class="number">50</span>]= <span class="string">&#x27;高&#x27;</span></span><br></pre></td></tr></table></figure>
<pre><code>&lt;ipython-input-97-d0c96ec6289a&gt;:1: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://img/pandas.pydata.org/img/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df.col1[df[&#39;col1&#39;] &gt; 50]= &#39;高&#39;
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.linalg.norm(df[<span class="string">&#x27;col2&#x27;</span>]-df[<span class="string">&#x27;col3&#x27;</span>])</span><br></pre></td></tr></table></figure>
<pre><code>248.99392792632952
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">df1= pd.DataFrame(&#123;<span class="string">&#x27;key1&#x27;</span>: [<span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K1&#x27;</span>, <span class="string">&#x27;K2&#x27;</span>],</span><br><span class="line"><span class="string">&#x27;key2&#x27;</span>: [<span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K1&#x27;</span>, <span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K1&#x27;</span>],</span><br><span class="line"><span class="string">&#x27;A&#x27;</span>: [<span class="string">&#x27;A0&#x27;</span>, <span class="string">&#x27;A1&#x27;</span>, <span class="string">&#x27;A2&#x27;</span>, <span class="string">&#x27;A3&#x27;</span>],</span><br><span class="line"><span class="string">&#x27;B&#x27;</span>: [<span class="string">&#x27;B0&#x27;</span>, <span class="string">&#x27;B1&#x27;</span>, <span class="string">&#x27;B2&#x27;</span>, <span class="string">&#x27;B3&#x27;</span>]&#125;)</span><br><span class="line"></span><br><span class="line">df2= pd.DataFrame(&#123;<span class="string">&#x27;key1&#x27;</span>: [<span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K1&#x27;</span>, <span class="string">&#x27;K1&#x27;</span>, <span class="string">&#x27;K2&#x27;</span>],</span><br><span class="line"><span class="string">&#x27;key2&#x27;</span>: [<span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K0&#x27;</span>],</span><br><span class="line"><span class="string">&#x27;C&#x27;</span>: [<span class="string">&#x27;C0&#x27;</span>, <span class="string">&#x27;C1&#x27;</span>, <span class="string">&#x27;C2&#x27;</span>, <span class="string">&#x27;C3&#x27;</span>],</span><br><span class="line"><span class="string">&#x27;D&#x27;</span>: [<span class="string">&#x27;D0&#x27;</span>, <span class="string">&#x27;D1&#x27;</span>, <span class="string">&#x27;D2&#x27;</span>, <span class="string">&#x27;D3&#x27;</span>]&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.merge(df1, df2, on=[<span class="string">&#x27;key1&#x27;</span>, <span class="string">&#x27;key2&#x27;</span>])</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key1</th>
      <th>key2</th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>K0</td>
      <td>K0</td>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>K1</td>
      <td>K0</td>
      <td>A2</td>
      <td>B2</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>K1</td>
      <td>K0</td>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.merge(df1, df2, how=<span class="string">&#x27;inner&#x27;</span>, on=[<span class="string">&#x27;key1&#x27;</span>, <span class="string">&#x27;key2&#x27;</span>])</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key1</th>
      <th>key2</th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>K0</td>
      <td>K0</td>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>K1</td>
      <td>K0</td>
      <td>A2</td>
      <td>B2</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>K1</td>
      <td>K0</td>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.merge(df1, df2, how=<span class="string">&#x27;left&#x27;</span>, on=[<span class="string">&#x27;key1&#x27;</span>, <span class="string">&#x27;key2&#x27;</span>])</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key1</th>
      <th>key2</th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>K0</td>
      <td>K0</td>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>K0</td>
      <td>K1</td>
      <td>A1</td>
      <td>B1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>K1</td>
      <td>K0</td>
      <td>A2</td>
      <td>B2</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>K1</td>
      <td>K0</td>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>K2</td>
      <td>K1</td>
      <td>A3</td>
      <td>B3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;<span class="number">0</span>: pd.Series(np.random.random_sample(<span class="number">100</span>)).<span class="built_in">map</span>(<span class="keyword">lambda</span> x: <span class="number">1</span> <span class="keyword">if</span> x&gt;=<span class="number">0.5</span> <span class="keyword">else</span> <span class="number">0</span>), </span><br><span class="line">              <span class="number">1</span>: pd.Series(np.random.random_sample(<span class="number">100</span>)).<span class="built_in">map</span>(<span class="keyword">lambda</span> x: <span class="number">1</span> <span class="keyword">if</span> x&gt;=<span class="number">0.5</span> <span class="keyword">else</span> <span class="number">0</span>),</span><br><span class="line">              <span class="number">2</span>: pd.Series(np.random.random_sample(<span class="number">100</span>)).<span class="built_in">map</span>(<span class="keyword">lambda</span> x: <span class="number">1</span> <span class="keyword">if</span> x&gt;=<span class="number">0.5</span> <span class="keyword">else</span> <span class="number">0</span>)&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">na = np.array(df)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.argwhere(na==<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 0,  0],
       [ 1,  1],
       [ 1,  2],
       [ 3,  0],
       [ 3,  1],
       [ 3,  2],
       [ 4,  2],
       [ 5,  0],
       [ 5,  1],
       [ 6,  0],
       [ 6,  2],
       [ 7,  0],
       [ 8,  0],
       [ 8,  2],
       [ 9,  2],
       [10,  2],
       [11,  2],
       [12,  0],
       [12,  1],
       [14,  0],
       [14,  1],
       [15,  0],
       [15,  2],
       [17,  0],
       [17,  2],
       [18,  2],
       [19,  0],
       [19,  2],
       [21,  1],
       [21,  2],
       [22,  0],
       [22,  1],
       [23,  2],
       [24,  0],
       [24,  1],
       [25,  0],
       [28,  1],
       [29,  1],
       [30,  0],
       [30,  1],
       [31,  2],
       [32,  0],
       [33,  0],
       [33,  1],
       [33,  2],
       [34,  0],
       [35,  0],
       [36,  1],
       [36,  2],
       [37,  1],
       [37,  2],
       [38,  0],
       [38,  1],
       [39,  0],
       [39,  1],
       [40,  0],
       [41,  1],
       [42,  1],
       [43,  0],
       [43,  1],
       [43,  2],
       [44,  2],
       [45,  2],
       [47,  1],
       [47,  2],
       [48,  1],
       [49,  0],
       [49,  1],
       [50,  0],
       [50,  1],
       [51,  2],
       [52,  2],
       [53,  1],
       [54,  0],
       [55,  0],
       [55,  2],
       [56,  0],
       [57,  2],
       [58,  0],
       [58,  1],
       [58,  2],
       [59,  2],
       [61,  1],
       [61,  2],
       [62,  1],
       [63,  0],
       [64,  1],
       [65,  0],
       [65,  1],
       [66,  0],
       [66,  1],
       [66,  2],
       [67,  2],
       [68,  0],
       [68,  1],
       [68,  2],
       [69,  0],
       [69,  2],
       [70,  2],
       [71,  0],
       [71,  1],
       [71,  2],
       [72,  1],
       [73,  1],
       [74,  2],
       [76,  1],
       [76,  2],
       [77,  1],
       [77,  2],
       [78,  1],
       [78,  2],
       [79,  0],
       [79,  2],
       [80,  1],
       [81,  0],
       [81,  1],
       [81,  2],
       [83,  1],
       [84,  0],
       [84,  1],
       [84,  2],
       [85,  0],
       [86,  0],
       [86,  1],
       [86,  2],
       [87,  2],
       [89,  0],
       [90,  0],
       [90,  2],
       [91,  1],
       [91,  2],
       [92,  1],
       [93,  0],
       [96,  0],
       [96,  2],
       [98,  0],
       [98,  1]])
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.pivot_table(df,values=[<span class="number">0</span>,<span class="number">1</span>],index=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
      <th>2</th>
    </tr>
    <tr>
      <th>0</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.418182</td>
      <td>0.490909</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.488889</td>
      <td>0.444444</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">&quot;./数据.csv&quot;</span>, encoding=<span class="string">&#x27;gbk&#x27;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!file -i 数据.csv</span><br></pre></td></tr></table></figure>
<pre><code>数据.csv: regular file
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!yum install enca</span><br></pre></td></tr></table></figure>
<pre><code>zsh:1: command not found: yum
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>positionId</th>
      <th>positionName</th>
      <th>companyId</th>
      <th>companyLogo</th>
      <th>companySize</th>
      <th>industryField</th>
      <th>financeStage</th>
      <th>companyLabelList</th>
      <th>firstType</th>
      <th>secondType</th>
      <th>...</th>
      <th>plus</th>
      <th>pcShow</th>
      <th>appShow</th>
      <th>deliver</th>
      <th>gradeDescription</th>
      <th>promotionScoreExplain</th>
      <th>isHotHire</th>
      <th>count</th>
      <th>aggregatePositionIds</th>
      <th>famousCompany</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6802721</td>
      <td>数据分析</td>
      <td>475770</td>
      <td>i/image2/M01/B7/3E/CgoB5lwPfEaAdn8WAABWQ0Jgl5s...</td>
      <td>50-150人</td>
      <td>移动互联网,电商</td>
      <td>A轮</td>
      <td>['绩效奖金', '带薪年假', '定期体检', '弹性工作']</td>
      <td>产品|需求|项目类</td>
      <td>数据分析</td>
      <td>...</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>[]</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5204912</td>
      <td>数据建模</td>
      <td>50735</td>
      <td>image1/M00/00/85/CgYXBlTUXeeAR0IjAABbroUk-dw97...</td>
      <td>150-500人</td>
      <td>电商</td>
      <td>B轮</td>
      <td>['年终奖金', '做五休二', '六险一金', '子女福利']</td>
      <td>开发|测试|运维类</td>
      <td>数据开发</td>
      <td>...</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>[]</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6877668</td>
      <td>数据分析</td>
      <td>100125</td>
      <td>image2/M00/0C/57/CgqLKVYcOA2ADcFuAAAE8MukIKA74...</td>
      <td>2000人以上</td>
      <td>移动互联网,企业服务</td>
      <td>上市公司</td>
      <td>['节日礼物', '年底双薪', '股票期权', '带薪年假']</td>
      <td>产品|需求|项目类</td>
      <td>数据分析</td>
      <td>...</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>[]</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6496141</td>
      <td>数据分析</td>
      <td>26564</td>
      <td>i/image2/M01/F7/3F/CgoB5lyGAQGAZeI-AAAdOqXecnw...</td>
      <td>500-2000人</td>
      <td>电商</td>
      <td>D轮及以上</td>
      <td>['生日趴', '每月腐败基金', '每月补贴', '年度旅游']</td>
      <td>开发|测试|运维类</td>
      <td>数据开发</td>
      <td>...</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>[]</td>
      <td>True</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6467417</td>
      <td>数据分析</td>
      <td>29211</td>
      <td>i/image2/M01/77/B8/CgoB5l1WDyGATNP5AAAlY3h88SY...</td>
      <td>2000人以上</td>
      <td>物流丨运输</td>
      <td>上市公司</td>
      <td>['技能培训', '免费班车', '专项奖金', '岗位晋升']</td>
      <td>产品|需求|项目类</td>
      <td>数据分析</td>
      <td>...</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>[]</td>
      <td>True</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>100</th>
      <td>6884346</td>
      <td>数据分析师</td>
      <td>21236</td>
      <td>i/image/M00/43/F6/CgqKkVeEh76AUVPoAAA2Bj747wU6...</td>
      <td>500-2000人</td>
      <td>移动互联网,医疗丨健康</td>
      <td>C轮</td>
      <td>['技能培训', '年底双薪', '节日礼物', '绩效奖金']</td>
      <td>产品|需求|项目类</td>
      <td>数据分析</td>
      <td>...</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>[]</td>
      <td>False</td>
    </tr>
    <tr>
      <th>101</th>
      <td>6849100</td>
      <td>商业数据分析</td>
      <td>72076</td>
      <td>i/image2/M01/92/A4/CgotOV2LPUmAR_8dAAB_DlDMiXA...</td>
      <td>500-2000人</td>
      <td>移动互联网,电商</td>
      <td>C轮</td>
      <td>['节日礼物', '股票期权', '带薪年假', '年度旅游']</td>
      <td>市场|商务类</td>
      <td>市场|营销</td>
      <td>...</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>[]</td>
      <td>False</td>
    </tr>
    <tr>
      <th>102</th>
      <td>6803432</td>
      <td>奔驰·耀出行-BI数据分析专家</td>
      <td>751158</td>
      <td>i/image3/M01/64/93/Cgq2xl48z2mAeYRoAAD6Qf_Jeq8...</td>
      <td>150-500人</td>
      <td>移动互联网</td>
      <td>不需要融资</td>
      <td>[]</td>
      <td>开发|测试|运维类</td>
      <td>数据开发</td>
      <td>...</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>[]</td>
      <td>False</td>
    </tr>
    <tr>
      <th>103</th>
      <td>6704835</td>
      <td>BI数据分析师</td>
      <td>52840</td>
      <td>i/image2/M00/26/CA/CgoB5lofsguAfk9ZAACoL3r4p24...</td>
      <td>2000人以上</td>
      <td>电商</td>
      <td>上市公司</td>
      <td>['技能培训', '年底双薪', '节日礼物', '绩效奖金']</td>
      <td>开发|测试|运维类</td>
      <td>数据开发</td>
      <td>...</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>[]</td>
      <td>True</td>
    </tr>
    <tr>
      <th>104</th>
      <td>6728058</td>
      <td>数据分析专家-LQ(J181203029)</td>
      <td>2474</td>
      <td>i/image2/M01/14/4D/CgoB5lyq5fqAAHHzAAAa148hbk8...</td>
      <td>2000人以上</td>
      <td>汽车丨出行</td>
      <td>不需要融资</td>
      <td>['弹性工作', '节日礼物', '岗位晋升', '技能培训']</td>
      <td>产品|需求|项目类</td>
      <td>数据分析</td>
      <td>...</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>[]</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
<p>105 rows × 53 columns</p>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.pivot_table(df,values=[<span class="string">&quot;companyId&quot;</span>,<span class="string">&quot;salary&quot;</span>,<span class="string">&quot;score&quot;</span>],index=<span class="string">&quot;positionId&quot;</span>)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>companyId</th>
      <th>salary</th>
      <th>score</th>
    </tr>
    <tr>
      <th>positionId</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5203054</th>
      <td>329</td>
      <td>30000</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>5204912</th>
      <td>50735</td>
      <td>15000</td>
      <td>176.0</td>
    </tr>
    <tr>
      <th>5269002</th>
      <td>50576</td>
      <td>37500</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5453691</th>
      <td>166666</td>
      <td>30000</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>5519962</th>
      <td>50735</td>
      <td>37500</td>
      <td>14.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6882983</th>
      <td>7461</td>
      <td>27500</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>6884346</th>
      <td>21236</td>
      <td>25000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>6886661</th>
      <td>321001</td>
      <td>37500</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>6888169</th>
      <td>751158</td>
      <td>42500</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>6896403</th>
      <td>285786</td>
      <td>30000</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
<p>95 rows × 3 columns</p>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install nbconvert pandoc</span><br></pre></td></tr></table></figure>
<pre><code>Requirement already satisfied: nbconvert in /Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages (6.0.7)
Collecting pandoc
  Downloading pandoc-2.3.tar.gz (33 kB)
Requirement already satisfied: nbclient&lt;0.6.0,&gt;=0.5.0 in /Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages (from nbconvert) (0.5.1)
Requirement already satisfied: traitlets&gt;=4.2 in /Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages (from nbconvert) (5.0.5)
Requirement already satisfied: nbformat&gt;=4.4 in /Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages (from nbconvert) (5.0.8)
Requirement already satisfied: pygments&gt;=2.4.1 in /Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages (from nbconvert) (2.7.2)
Requirement already satisfied: defusedxml in /Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages (from nbconvert) (0.6.0)
Requirement already satisfied: jupyter-core in /Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages (from nbconvert) (4.6.3)
Requirement already satisfied: pandocfilters&gt;=1.4.1 in /Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages (from nbconvert) (1.4.3)
Requirement already satisfied: mistune&lt;2,&gt;=0.8.1 in /Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages (from nbconvert) (0.8.4)
Requirement already satisfied: jupyterlab-pygments in /Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages (from nbconvert) (0.1.2)
Requirement already satisfied: testpath in /Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages (from nbconvert) (0.4.4)
Requirement already satisfied: entrypoints&gt;=0.2.2 in /Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages (from nbconvert) (0.3)
Requirement already satisfied: bleach in /Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages (from nbconvert) (3.2.1)
Requirement already satisfied: jinja2&gt;=2.4 in /Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages (from nbconvert) (2.11.2)
Collecting plumbum
  Downloading plumbum-1.8.2-py3-none-any.whl (127 kB)
[K     |████████████████████████████████| 127 kB 14 kB/s eta 0:00:01
[?25hRequirement already satisfied: ply in /Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages (from pandoc) (3.11)
Requirement already satisfied: async-generator in /Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages (from nbclient&lt;0.6.0,&gt;=0.5.0-&gt;nbconvert) (1.10)
Requirement already satisfied: jupyter-client&gt;=6.1.5 in /Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages (from nbclient&lt;0.6.0,&gt;=0.5.0-&gt;nbconvert) (6.1.7)
Requirement already satisfied: nest-asyncio in /Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages (from nbclient&lt;0.6.0,&gt;=0.5.0-&gt;nbconvert) (1.4.2)
Requirement already satisfied: ipython-genutils in /Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages (from traitlets&gt;=4.2-&gt;nbconvert) (0.2.0)
Requirement already satisfied: jsonschema!=2.5.0,&gt;=2.4 in /Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages (from nbformat&gt;=4.4-&gt;nbconvert) (3.2.0)
Requirement already satisfied: webencodings in /Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages (from bleach-&gt;nbconvert) (0.5.1)
Requirement already satisfied: six&gt;=1.9.0 in /Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages (from bleach-&gt;nbconvert) (1.15.0)
Requirement already satisfied: packaging in /Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages (from bleach-&gt;nbconvert) (20.4)
Requirement already satisfied: MarkupSafe&gt;=0.23 in /Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages (from jinja2&gt;=2.4-&gt;nbconvert) (1.1.1)
Requirement already satisfied: python-dateutil&gt;=2.1 in /Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages (from jupyter-client&gt;=6.1.5-&gt;nbclient&lt;0.6.0,&gt;=0.5.0-&gt;nbconvert) (2.8.1)
Requirement already satisfied: pyzmq&gt;=13 in /Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages (from jupyter-client&gt;=6.1.5-&gt;nbclient&lt;0.6.0,&gt;=0.5.0-&gt;nbconvert) (19.0.2)
Requirement already satisfied: tornado&gt;=4.1 in /Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages (from jupyter-client&gt;=6.1.5-&gt;nbclient&lt;0.6.0,&gt;=0.5.0-&gt;nbconvert) (6.0.4)
Requirement already satisfied: pyrsistent&gt;=0.14.0 in /Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages (from jsonschema!=2.5.0,&gt;=2.4-&gt;nbformat&gt;=4.4-&gt;nbconvert) (0.17.3)
Requirement already satisfied: setuptools in /Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages (from jsonschema!=2.5.0,&gt;=2.4-&gt;nbformat&gt;=4.4-&gt;nbconvert) (50.3.1.post20201107)
Requirement already satisfied: attrs&gt;=17.4.0 in /Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages (from jsonschema!=2.5.0,&gt;=2.4-&gt;nbformat&gt;=4.4-&gt;nbconvert) (20.3.0)
Requirement already satisfied: pyparsing&gt;=2.0.2 in /Users/wingo.wen/opt/anaconda3/lib/python3.8/site-packages (from packaging-&gt;bleach-&gt;nbconvert) (2.4.7)
Building wheels for collected packages: pandoc
  Building wheel for pandoc (setup.py) ... [?25ldone
[?25h  Created wheel for pandoc: filename=pandoc-2.3-py3-none-any.whl size=33271 sha256=22e3e077eb44a4ba73332321d2656d5d67e118abef8947040a2719d096f363f4
  Stored in directory: /Users/wingo.wen/Library/Caches/pip/wheels/90/3a/a8/3237a93e3a6261bd24edabf3277ca59f64c1710b3d8c7c72a0
Successfully built pandoc
Installing collected packages: plumbum, pandoc
Successfully installed pandoc-2.3 plumbum-1.8.2
Note: you may need to restart the kernel to use updated packages.
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!jupyter nbconvert --to markdown pandas.ipynb</span><br></pre></td></tr></table></figure>

      
    </div>
    <!-- <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="https://wingowen.github.io/2023/09/19/Python/Pandas-%E7%BB%83%E4%B9%A0/" title="Pandas 练习" target="_blank" rel="external">https://wingowen.github.io/2023/09/19/Python/Pandas-练习/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/avatar.jpg" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="" target="_blank"><span class="text-dark">WINGO.WEN</span><small class="ml-1x"></small></a></h3>
        <div>一个疯子。</div>
      </div>
    </figure>
  </div>
</div>


    </div> -->
  </article>
  
    
  <section id="comments">
  	
  </section>


  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/2023/09/19/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/" title="大数据组件"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a>
    </li>
    
    
    <li class="next">
      <a href="/2023/09/19/%E6%95%B0%E6%8D%AE%E5%BA%93/SQL-%E7%BB%83%E4%B9%A0/" title="SQL 练习"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
    <li class="toggle-toc">
      <a class="toggle-btn " data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button">    <span>[&nbsp;</span><span>文章目录</span>
        <i class="text-collapsed icon icon-anchor"></i>
        <i class="text-in icon icon-close"></i>
        <span>]</span>
      </a>
    </li>
    
  </ul>
  
  
  
  <div class="bar-right">
    
  </div>
  </div>
</nav>
  


</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
    <div class="copyright">
    	
        <div class="publishby">
        	<!-- Theme by <a href="https://github.com/cofess" target="_blank"> cofess </a>base on <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a>. -->
        </div>
    </div>
</footer>
  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>






   




   






</body>
</html>